<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Multi-DOM Sentence Highlighting Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 40px auto;
            padding: 20px;
            line-height: 1.6;
        }
        .test-section {
            margin: 30px 0;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 8px;
        }
        .highlight-instruction {
            background: #f0f8ff;
            padding: 15px;
            border-left: 4px solid #0066cc;
            margin: 20px 0;
        }
        .api-status {
            padding: 10px;
            border-radius: 4px;
            margin: 10px 0;
            font-weight: bold;
        }
        .supported { background: #d4edda; color: #155724; }
        .not-supported { background: #f8d7da; color: #721c24; }
    </style>
</head>
<body>
    <h1>Multi-DOM Sentence Highlighting Test</h1>
    
    <div id="api-status" class="api-status">
        Checking CSS Custom Highlight API support...
    </div>

    <div class="highlight-instruction">
        <strong>Instructions:</strong>
        <ol>
            <li>Load the TTS Chrome Extension</li>
            <li>Select text that spans multiple elements below</li>
            <li>Use the extension's sentence highlighting feature</li>
            <li>Observe that individual sentences are highlighted correctly, even across element boundaries</li>
            <li><strong>Test stopping:</strong> Press <kbd>Ctrl+Q</kbd> while sentence highlighting is active</li>
            <li>Verify that all highlights immediately disappear and sentence progression stops</li>
        </ol>
        <p><strong>Expected behavior:</strong> CSS Custom Highlight API provides seamless highlighting across any DOM structure with instant cleanup when stopped.</p>
    </div>

    <div class="test-section">
        <h2>Test Case 1: Text Across Paragraphs</h2>
        <p>This is the first sentence in a paragraph. This is the second sentence that continues <strong>with some bold text</strong> in the same paragraph.</p>
        <p>This sentence starts in a different paragraph. It demonstrates how the new CSS Custom Highlight API can highlight sentences that span across multiple DOM elements without any issues.</p>
        <p>The final sentence completes our multi-paragraph test case.</p>
    </div>

    <div class="test-section">
        <h2>Test Case 2: Complex Nested Elements</h2>
        <div>
            This sentence begins in a div element. <span>It continues through a span element</span> and <em>includes emphasized text</em> before ending.
        </div>
        <div>
            <strong>This bold sentence</strong> spans multiple elements including <code>inline code</code> and <a href="#">a link</a> to test complex DOM structures.
        </div>
    </div>

    <div class="test-section">
        <h2>Test Case 3: List Items</h2>
        <ul>
            <li>First list item with a sentence. This continues the sentence across the same item.</li>
            <li>Second list item starts here. <strong>Bold text in the middle</strong> and continues to the end.</li>
            <li>Third item completes the list.</li>
        </ul>
    </div>

    <div class="test-section">
        <h2>Test Case 4: Mixed Block and Inline Elements</h2>
        <div>
            <h3>Subheading text here.</h3>
            <p>Paragraph text that follows the heading. <span>Inline span content</span> mixed with regular text.</p>
            <blockquote>
                Quoted text that forms complete sentences. This quote contains multiple sentences for testing purposes.
            </blockquote>
        </div>
    </div>

    <script>
        // Check CSS Custom Highlight API support
        function checkAPISupport() {
            const statusEl = document.getElementById('api-status');
            
            if (typeof CSS !== 'undefined' && 'highlights' in CSS) {
                statusEl.textContent = '✅ CSS Custom Highlight API is supported in this browser!';
                statusEl.className = 'api-status supported';
                
                // Demo the API
                console.log('CSS Custom Highlight API detected and working!');
            } else {
                statusEl.textContent = '❌ CSS Custom Highlight API is not supported in this browser.';
                statusEl.className = 'api-status not-supported';
                
                console.log('CSS Custom Highlight API not available - will use fallback highlighting');
            }
        }

        // Run the check when page loads
        document.addEventListener('DOMContentLoaded', checkAPISupport);
        
        // Also log some useful info for debugging
        console.log('Test page loaded. Browser:', navigator.userAgent);
        console.log('CSS object available:', typeof CSS !== 'undefined');
        if (typeof CSS !== 'undefined') {
            console.log('CSS.highlights available:', 'highlights' in CSS);
        }
    </script>
</body>
</html>